angular.module("app",["ngRoute"]),angular.module("app").controller("ApplicationCtrl",["$scope",function(o){o.$on("login",function(t,e){console.log(e),o.currentUser=e})}]),angular.module("app").controller("LoginCtrl",["$scope","UserSvc",function(o,t){o.login=function(e,n){t.login(e,n).then(function(t){console.log(t),o.$emit("login",t.data)})}}]),angular.module("app").controller("PostsCtrl",["$scope","PostsSvc",function(o,t){o.addPost=function(){o.postBody&&t.create({username:"lenmorld",body:o.postBody}).then(function(t){o.posts.unshift(t),o.postBody=null,o.fetchAll()})},o.fetchAll=function(){t.fetch().then(function(t){console.log(t),o.posts=t.data})},o.fetchAll()}]),angular.module("app").service("PostsSvc",["$http",function(o){console.error("sample error!"),this.fetch=function(){return o.get("/api/posts")},this.create=function(t){return o.post("/api/posts",t)}}]),angular.module("app").config(["$routeProvider","$locationProvider",function(o,t){t.hashPrefix(""),o.when("/",{controller:"PostsCtrl",templateUrl:"posts.html"}).when("/register",{controller:"RegisterCtrl",templateUrl:"register.html"}).when("/login",{controller:"LoginCtrl",templateUrl:"login.html"})}]),angular.module("app").service("UserSvc",["$http",function(o){var t=this;t.getUser=function(){return console.log("getUser: ",this.token),o.get("/api/users",{headers:{"X-Auth":this.token}})},t.login=function(e,n){return o.post("/api/sessions",{username:e,password:n}).then(function(o){return console.log("login data: ",o),t.token=o.data,t.getUser()})}}]);